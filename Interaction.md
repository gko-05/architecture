# Взаимодействие сервисов

Критический сценарий:
    - Пользователи массово присваивают коды к объектам недвижимости и могут выгружать результат.

Причина оценки решения: первичная.

# Сервисы

## Сервис "Реестр объектов"

Описание: Сервис по управлению входящими реестра объектов недвижимости

Запросы:
 - получить объекты из входного реестра.

Команды: -

События: -

Зависимости: -

## Сервис "Реестр кодировки"

Описание: Сервис по кодированию и зонированию входящих объектов недвижимости входного реестра

Запросы:
 - получить все объекты из реестра кодирования;
 - получить объекты из реестра кодирования по фильтру; 
 - получить список кодировок по справочнику;
 - получить список зон.

Команды:
 - создать реестр кодирования;
 - заполнить реестр кодирования объектами из заданного входного реестра;
 - применить код и зону к объектам реестра кодирования согласно фильтру.

События: -

Зависимости:
 - Реестр объектов;
 - Реестр зон.

## Сервис "Реестр зон"

Описание: Сервис по управлению зон оценки.

Запросы:
 - получить актуальные зоны из реестра зон.

Команды: -

События: -

Зависимости: -

# Диаграмма последовательности

![Диаграмма последовательности](<Диаграмма последовательности.jpg>)

# Оценка атрибутов качества

Определив ключевые характеристики архитектуры для этого решения, мы сможем затем определить наименее худшее решение.

## Функциональные требования

Сценарий: пользователи массово присваивают коды к объектам недвижимости и могут выгружать результат.

Характеристики:
 - решение частично реализует сценарий - необходимо добавить выгрузку.
 - Стоимость изменений

    CAPEX = Стоимость з/п.
    Стоимость инфраструктуры = 0, так как инфраструктуру под проект уже имеется.

    OPEX = Стоимость поддержки (Стоимость з/п).
    Стоимость лицензий = 0, будем использовать open source решения.

 - Скорость изменений: в следствии микросервисной архитектуры, то скорость изменений будет приемлемой.

## Отказоустойчивость

Кодировка одна из самых важных частей системы.

Сценарии:

    1. Падение одного из сервисов или СУБД.
    Доступность для клиента = Доступности всех сервисов и БД.

Комментарии: возможно необходимо проработать вопрос кэширования "Реестра зон" на стороне "Реестра кодировки". Так же необходимо продумать сценарий восстановления БД из бэкапа.

## Производительность

Сценарии:
    
    1. Система должна иметь приемлемый отклик при повышении объёма данных.

    - Время ответа для клиента, поскольку взаимодействие синхронное можно
    оценить как максимальное время одного из сервиса.
    Latency для клиента = максимальное время отклика одного из сервиса
    
    - Пропускная способность.
    RPS = минимальным RPS одного из сервиса.

Комментарии: производительность системы является важным атрибутом качества. Система должно иметь оптимизированное хранилище данных способная обрабатывать большой объем данных. 

## Модифицируемость

Сценарии:

    1. Изменение модели данных "Реестра объектов"
    
    - Стоимость изменений = И(поправить схему "Реестра объектов") + И(поправить схему "Реестра кодировки")

Комментарии: возможно стоит хранить данные "Реестра кодировки" и возможно "Реестра объектов" в не реляционной БД.


## Масштабируемость

Сценарии:

    1. Увеличение объема хранимых данных в 10 раз за год
    
    Система должна масштабироваться под увеличивающийся объём данных.
    
    Стоимость масштабирования = затраты на инфраструктуру
    
    Оценка деградация производительности оценить сложно ввиду многих влияния факторов: индексы, запросы и структура.

Комментарии: необходимо предусмотреть правильную структуру и подбор индексов БД, влияющих на производительность. Возможность масштабирования возможно достигнуть: вертикальным масштабированием - увеличение памяти, процессоров и т.д.; горизонтальным масштабированием  - вводом дополнительных нод.